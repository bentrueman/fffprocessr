peak_maxima(peaks = 9, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 10, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 11, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 12, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 13, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 14, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 15, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 16, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 20, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
use_r("peak_maxima")
list(a=1,b=2)
list(a=1,b=2) %>% bind_rows(tibble(a = 1, b=2))
list(a=1,b=2) %>% bind_rows(tibble(a = 3, b=4))
document()
load_all()
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 20, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
peak_tbl <- tibble::tibble()
peak_tbl
document()
load_all()
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 20, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
peak_id_sigma()
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>% peak_id_sigma()
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>% peak_id_sigma(peaks = 2)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>% peak_id_sigma(peaks = 2, max_iter = 20)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>% peak_id_sigma(focus = 1, peaks = 2, max_iter = 20)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>% peak_id_sigma(focus = 1, peaks = 2, max_iter = 20)
peak_list <- list()
peak_tbl <- tibble::tibble()
dplyr::bind_rows(peak_tbl, peak_list)
document()
?peak_maxima
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3)
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3, method = "sigma")
document()
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3, method = "sigma")
document()
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3, method = "sigma")
document()
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 20, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 1, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 2, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 3, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 4, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 5, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 6, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 7, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 8, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 9, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 21, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 21, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
) + geom_vline(xintercept = 109)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 21, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
) + geom_vline(xintercept = 10)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 19, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
) + geom_vline(xintercept = 10)
tibble(
time = 1:100,
conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})
) %>%
mutate(date = 1, sample = 1, param = 1) %>%
ggplot(aes(time, conc)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima(peaks = 21, method = "sigma"),
aes(tr, conc_tr), inherit.aes = FALSE, col = "red"
) + geom_vline(xintercept = 10)
document()
test()
check()
library(devtools)
load_all()
tibble(x = 1:100, y = )
library("tidyverse")
tibble(x = 1:100, y = rlnorm(length(x), sdlog = 3))
tibble(x = 1:100, y = rlnorm(length(x), sdlog = 3)) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = rlnorm(length(x), sdlog = 3)) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>%
ggplot(aes(x, y)) +
geom_line()
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>%
ggplot(aes(x, y)) +
geom_line() +
geom_point(
data = function(x) x %>%
peak_maxima()
)
tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})) %>% peak_maxima()
use_test("peak_maxima")
?expect_error
peak_maxima(tibble::tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})))
peak_maxima(tibble::tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})))
expect_equal(
class(peak_maxima(tibble::tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)}))))
)
class(peak_maxima(tibble::tibble(x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)}))))
class(peak_maxima(tibble::tibble( date = 1, x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)}))))
class(peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)}))))
class(peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, time = 1:100, conc = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)}))))
class(peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, time = 1:100, conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)}))))
peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, time = 1:100, conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})))
peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, time = 1:100, conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)}))) %>% class()
tibble::tibble(
x = 1:100,
y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})
)
peak_maxima(
tibble::tibble(
x = 1:100,
y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})
)
)
is.data.frame()
class(peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)}))))
class(peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, x = 1:100, y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)}))))
peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, time = 1:100, conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)}))) %>% class()
peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, time = 1:100, conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)})))
peak_maxima(
tibble::tibble(
x = 1:100,
y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})
),
group_vars = NULL,
)
peak_maxima(tibble::tibble( date = 1, sample = 1, param = 1, time = 1:100, conc = withr::with_seed(101, {rlnorm(length(time), sdlog = 3)}))) %>% is.data.frame()
test_that("peak_maxima() accepts any grouping variables"{
expect_equal(
is.data.frame(
peak_maxima(
tibble::tibble(
x = 1:100,
y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})
),
group_vars = NULL,
)
),
TRUE
)
})
test_that("peak_maxima() accepts any grouping variables"{
expect_equal(
is.data.frame(
peak_maxima(
tibble::tibble(
x = 1:100,
y = withr::with_seed(101, {rlnorm(length(x), sdlog = 3)})
),
group_vars = NULL,
)
),
TRUE
)
})
library(devtools)
use_r("peak_maxima")
document()
load_all()
?peak_maxima
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3)
document()
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3)
document()
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3)
path <- system.file("extdata", package = "fffprocessr")
data <- combine_fff(load_icp(path))
data <- data[data$param == "65Cu", ]
peak_maxima(data, peaks = 3, method = "sigma")
use_r("load_uv")
document()
peak_maxima(data, peaks = 3)
peak_maxima(data, peaks = 3, method = "sigma")
document()
peak_maxima(data, peaks = 3, method = "sigma")
peak_maxima(data, peaks = 3, method = "sigma", n = 3)
peak_maxima(data, peaks = 3, method = "sigma", n = 5)
peak_maxima(data, peaks = 3)
document()
test()
use_test("peak_maxima")
test()
check()
# create a single input string
c_inputs <- function(input, number) paste(c("x", paste0(input, number)), collapse = ", ")
c_inputs(c("h", "mu", "s", "g"), 2)
document()
rm(list = c("c_inputs"))
document()
test()
run_examples()
document()
run_examples()
test()
check()
